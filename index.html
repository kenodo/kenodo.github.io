<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Проект</title>
    <link rel="stylesheet" href="main.css">
    <link rel="stylesheet" href="magic.css">
    
    <script src="https://code.jquery.com/jquery-3.3.1.js"></script>
</head>
<body>
  
  
<div class="loading" style="width:100%;height:900px;background-color: azure;display:block;">
   <h1 style="text-align: center;padding-top:25%;">Загрузка...</h1>
</div>
   
<div class="scene scene1" style="display:none">
    <div class="ground"> </div>
    <div class="object"></div>
   
      <div class="player">
            <p style="color: white;"></p>
        </div>
       
       
       <div class="pug">
          
       </div>
       
        <div class="love"></div>
       
       <div class="book"></div>
       
       <div class="bookScreen">
           <img id="bScr" src="diary/1.png">
           <h1 id="pieces">1/4</h1>
       </div>
       
       <div class="key"></div>
       
       <div class="bookIcon"></div>
       
       <div class="stone"></div>
       
       <div class="tree"></div>
       
       <div class="keyIcon"></div>
       
    
</div>
       
      
 <script>
     
     
     window.onload = function(){
         console.log("loaded");
         setTimeout('$(".scene").show(1500);$(".loading").hide();',1000);
};
     
     
        
        var position = 800;
        var moveLeft=false;
        var moveRight=false;
        var mops=false;
        var book=false;
        var key=false;
        var pieces=1;
        
        
        function checkBorderLeft(){
        
            ////
        
        }
        
        
        
        function checkBorderRight(){
        
            ///
            
        }
        
        
        function mopsNormal(){
            
            
            
            $(".pug").css("background-image","url('pugStand.gif')");
        }
        
        
        function normalStateImage(){
             $(".player").css("background-image","url('перс.png')");
            
            
           if(mops) setTimeout(mopsNormal,1000);
        }
    
 
        
        
        
(function() {
    document.onmousemove = handleMouseMove;
    function handleMouseMove(event) {
       
        
        

        event = event || window.event; // IE-ism


        // Use event.pageX / event.pageY here
        
         var x=event.clientX;
         var y=event.clientY; 
        
        function checkLeftRight(){
           if (event.clientX>position){
                moveLeft=false;
                moveRight=true;
            }
            
            else if (event.clientX<position){
                moveLeft=true;
                moveRight=false;
            }          
        }
        
        
        function playerMove(){
              $(".player").css("background-image","url('перс.gif')");
        if (mops)$(".pug").css("background-image","url('pugRun.gif')");
            
            
          $(".player").css("left",x);
          $(".love").css("left",x-80)
            if(mops)$(".pug").css("left",x-80);   
            
             position = event.clientX;
            
            if (moveLeft){
                 $(".player").css("transform","scaleX(1)");
                  if (mops) $(".pug").css("transform","scaleX(1)");
            }
            
            if (moveRight){
                 $(".player").css("transform","scaleX(-1)");
                  if(mops)$(".pug").css("transform","scaleX(-1)");
            }
            
            
            setTimeout(normalStateImage,2000);
        }
        
        
        function addKey(){
            key=true;
            $(".key").hide(300);
            $(".keyIcon").show(500);
            pieces=3;
        }
        
        
        
        $( ".ground" ).click(function() {
            
          $(".bookScreen").hide(1000);         
            
           checkLeftRight();
           playerMove();
            
        });
        
        
        
        function bookDisplay(){
            $(".bookScreen").show(1000);
            book=true;
            $(".book").hide(500);
            $(".bookIcon").show(100);
        }
        
        
        function mopsLove(){
            
            if(!mops){
                
                 $(".love").css("left",160);
            $(".love").show(500);
                mops=true;
                pieces=2;
             
             setInterval(function(){ 
	$('.love').toggleClass('magictime puffOut');
}, 1000 );
              setInterval(function(){ 
	$('.love').toggleClass('magictime puffIn');
}, 2000 );
            }
            
           
        }
        
        
        $( ".book" ).click(function() {         
            
            checkLeftRight();
            playerMove();
            setTimeout(bookDisplay,2000);
        });
        
        
        $( ".book" ).click(function() {         
            checkLeftRight();
            playerMove();
            setTimeout(bookDisplay,2000);
        });
        
        
         $( ".key" ).click(function() {         
            
            checkLeftRight();
            playerMove();
            setTimeout(addKey,2000);
        });
        
        
        $(".bookIcon").click(function(){
            console.log(pieces);
            $("#bScr").attr("src", "diary/" + pieces + ".png");
            $("#pieces").text(pieces+"/4");
            
            
             $(".bookScreen").show(1000);
                mops=true;
        });
        
         $(".pug").click(function(){
             
        
               
            
            checkLeftRight();
            playerMove();
            setTimeout(mopsLove,2000);
     
         
         
         });
        //
    }
})();
    
    </script>
</body>
</html>